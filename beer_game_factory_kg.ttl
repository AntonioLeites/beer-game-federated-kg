# ============================================================
# BEER GAME - FACTORY KNOWLEDGE GRAPH
# Federated endpoint: http://localhost:7200/repositories/BeerGame_Factory
# ============================================================

@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix bg: <http://beergame.org/ontology#> .
@prefix bg_distributor: <http://beergame.org/distributor#> .
@prefix bg_factory: <http://beergame.org/factory#> .

#### FACTORY ACTOR ####

bg_factory:Factory_Delta a bg:Factory ;
    rdfs:label "Factory Delta" ;
    bg:agentModel "GPT-5"^^xsd:string ;
    bg:agentPrompt """You are the Factory in a beer distribution game.
You are the furthest upstreamâ€”you produce beer based on distributor orders.
Your production decisions affect the entire supply chain.
Query federated KGs to see TOTAL supply chain demand, not just your immediate orders.
Smooth production to avoid bullwhip amplification."""^^xsd:string ;
    bg:shippingDelay "2"^^xsd:integer ;
    bg:orderDelay "1"^^xsd:integer ;
    bg:suppliesTo bg_distributor:Distributor_Gamma ;
    bg:budgetConstraint "50000.00"^^xsd:decimal ;  # Higher capacity
    bg:totalCost "0.00"^^xsd:decimal .

#### PRODUCTION CAPACITY ####

bg_factory:ProductionCapacity a bg:ProductionLine ;
    bg:maxProductionRate "100"^^xsd:integer ;  # Can produce up to 100 units/week
    bg:currentProductionRate "4"^^xsd:integer ;  # Currently producing 4/week
    rdfs:label "Beer Production Line" .

#### CURRENT INVENTORY STATE (Week 1) ####

bg_factory:Inventory_Week1 a bg:Inventory ;
    bg:weekNumber "1"^^xsd:integer ;
    bg:currentInventory "12"^^xsd:integer ;
    bg:backlog "0"^^xsd:integer ;
    bg:incomingShipment "0"^^xsd:integer ;  # Factory produces, doesn't receive
    bg:outgoingShipment "0"^^xsd:integer ;
    bg:holdingCost "0.50"^^xsd:decimal ;
    bg:backlogCost "1.00"^^xsd:decimal .

#### INCOMING ORDER FROM DISTRIBUTOR (Week 1) ####

bg_factory:ReceivedOrder_Week1 a bg:Order ;
    bg:weekNumber "1"^^xsd:integer ;
    bg:placedBy bg_distributor:Distributor_Gamma ;
    bg:receivedBy bg_factory:Factory_Delta ;
    bg:orderQuantity "4"^^xsd:integer .

#### PRODUCTION DECISION (Week 1) ####

bg_factory:ProductionOrder_Week1 a bg:ProductionOrder ;
    bg:weekNumber "1"^^xsd:integer ;
    bg:producedQuantity "4"^^xsd:integer ;
    bg:completionWeek "2"^^xsd:integer ;  # Production takes 1 week
    rdfs:comment "Produce to match current demand" .

#### SHIPMENT TO DISTRIBUTOR ####

bg_factory:Shipment_Week1 a bg:Shipment ;
    bg:weekNumber "1"^^xsd:integer ;
    bg:shippedFrom bg_factory:Factory_Delta ;
    bg:shippedTo bg_distributor:Distributor_Gamma ;
    bg:shippedQuantity "4"^^xsd:integer ;
    bg:arrivalWeek "3"^^xsd:integer .

#### AGENT DECISION METRICS ####

bg_factory:Metrics_Week1 a bg:Actor ;
    bg:demandRate "4.0"^^xsd:decimal ;
    bg:inventoryCoverage "3.0"^^xsd:decimal ;
    bg:hasBullwhipRisk "false"^^xsd:boolean ;
    bg:hasStockoutRisk "false"^^xsd:boolean .

#### RAW MATERIALS (Factory-Specific) ####

bg_factory:RawMaterials_Week1 a bg:RawMaterials ;
    bg:hopsInventory "500"^^xsd:integer ;
    bg:maltInventory "800"^^xsd:integer ;
    bg:yeastInventory "200"^^xsd:integer ;
    rdfs:comment "Sufficient materials for 100+ weeks" .

#### FEDERATED QUERY FOR TOTAL SUPPLY CHAIN VISIBILITY ####

# Query: Aggregate demand across entire supply chain
# SELECT (SUM(?demand) as ?totalDemand)
# WHERE {
#   {
#     SERVICE <http://localhost:7200/repositories/BeerGame_Retailer> {
#       ?d a bg:CustomerDemand ; bg:actualDemand ?demand .
#     }
#   }
#   UNION
#   {
#     SERVICE <http://localhost:7200/repositories/BeerGame_Wholesaler> {
#       ?o bg:orderQuantity ?demand .
#     }
#   }
#   UNION
#   {
#     SERVICE <http://localhost:7200/repositories/BeerGame_Distributor> {
#       ?o bg:orderQuantity ?demand .
#     }
#   }
# }

# Factory can see TOTAL pipeline demand to optimize production scheduling
