# ============================================================
# BEER GAME - DISTRIBUTOR KNOWLEDGE GRAPH
# Federated endpoint: http://localhost:7200/repositories/BeerGame_Distributor
# ============================================================

@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix bg: <http://beergame.org/ontology#> .
@prefix bg_wholesaler: <http://beergame.org/wholesaler#> .
@prefix bg_distributor: <http://beergame.org/distributor#> .
@prefix bg_factory: <http://beergame.org/factory#> .

#### DISTRIBUTOR ACTOR ####

bg_distributor:Distributor_Gamma a bg:Distributor ;
    rdfs:label "Distributor Gamma" ;
    bg:agentModel "Claude-Sonnet-4"^^xsd:string ;
    bg:agentPrompt """You are the Distributor in a beer distribution game.
You supply wholesalers and order from the factory.
Use federated queries to trace REAL demand back to end customers.
Apply SWRL rules to detect bullwhip amplification early."""^^xsd:string ;
    bg:shippingDelay "2"^^xsd:integer ;
    bg:orderDelay "1"^^xsd:integer ;
    bg:suppliesTo bg_wholesaler:Wholesaler_Beta ;
    bg:ordersFrom bg_factory:Factory_Delta ;
    bg:budgetConstraint "20000.00"^^xsd:decimal ;
    bg:totalCost "0.00"^^xsd:decimal .

#### CURRENT INVENTORY STATE (Week 1) ####

bg_distributor:Inventory_Week1 a bg:Inventory ;
    bg:weekNumber "1"^^xsd:integer ;
    bg:currentInventory "12"^^xsd:integer ;
    bg:backlog "0"^^xsd:integer ;
    bg:incomingShipment "0"^^xsd:integer ;
    bg:outgoingShipment "0"^^xsd:integer ;
    bg:holdingCost "0.50"^^xsd:decimal ;
    bg:backlogCost "1.00"^^xsd:decimal .

#### INCOMING ORDER FROM WHOLESALER (Week 1) ####

bg_distributor:ReceivedOrder_Week1 a bg:Order ;
    bg:weekNumber "1"^^xsd:integer ;
    bg:placedBy bg_wholesaler:Wholesaler_Beta ;
    bg:receivedBy bg_distributor:Distributor_Gamma ;
    bg:orderQuantity "4"^^xsd:integer .

#### DISTRIBUTOR'S ORDER TO FACTORY (Week 1) ####

bg_distributor:Order_Week1 a bg:Order ;
    bg:weekNumber "1"^^xsd:integer ;
    bg:placedBy bg_distributor:Distributor_Gamma ;
    bg:receivedBy bg_factory:Factory_Delta ;
    bg:orderQuantity "4"^^xsd:integer ;
    rdfs:comment "Maintaining stability in the supply chain" .

#### SHIPMENTS ####

bg_distributor:Shipment_Week1_ToWholesaler a bg:Shipment ;
    bg:weekNumber "1"^^xsd:integer ;
    bg:shippedFrom bg_distributor:Distributor_Gamma ;
    bg:shippedTo bg_wholesaler:Wholesaler_Beta ;
    bg:shippedQuantity "4"^^xsd:integer ;
    bg:arrivalWeek "3"^^xsd:integer .

bg_distributor:Shipment_Week1_FromFactory a bg:Shipment ;
    bg:weekNumber "1"^^xsd:integer ;
    bg:shippedFrom bg_factory:Factory_Delta ;
    bg:shippedTo bg_distributor:Distributor_Gamma ;
    bg:shippedQuantity "4"^^xsd:integer ;
    bg:arrivalWeek "3"^^xsd:integer .

#### AGENT DECISION METRICS ####

bg_distributor:Metrics_Week1 a bg:Actor ;
    bg:demandRate "4.0"^^xsd:decimal ;
    bg:inventoryCoverage "3.0"^^xsd:decimal ;
    bg:hasBullwhipRisk "false"^^xsd:boolean ;
    bg:hasStockoutRisk "false"^^xsd:boolean .

#### FEDERATED QUERY TO DETECT BULLWHIP ####

# Query: Compare wholesaler's order to actual end-customer demand
# SELECT ?wholesalerOrder ?realDemand (?wholesalerOrder / ?realDemand as ?amplification)
# WHERE {
#   ?order bg:placedBy bg_wholesaler:Wholesaler_Beta ;
#          bg:orderQuantity ?wholesalerOrder ;
#          bg:weekNumber ?week .
#   
#   SERVICE <http://localhost:7200/repositories/BeerGame_Retailer> {
#     ?demand a bg:CustomerDemand ;
#             bg:weekNumber ?week ;
#             bg:actualDemand ?realDemand .
#   }
# }

# If amplification > 1.3, apply SWRL rule to cap distributor's order
